# exports.schema
# Jason B. Alonso <jalonso@hackorp.com>
# LDAP schema for exports_ldap.py

attributetype ( 1.3.6.1.4.1.33578.1.1.3.1.1 NAME 'exportsPath'
        DESC 'NFS export path'
	EQUALITY caseExactMatch
	SUBSTR caseExactSubstringsMatch
	SYNTAX 1.3.6.1.4.1.1466.115.121.1.15
        SINGLE-VALUE )

attributetype ( 1.3.6.1.4.1.33578.1.1.3.1.2 NAME 'exportsClientPattern'
        DESC 'Client pattern for NFS export'
	EQUALITY caseExactMatch
	SUBSTR caseExactSubstringsMatch
	SYNTAX 1.3.6.1.4.1.1466.115.121.1.15
        SINGLE-VALUE )

attributetype ( 1.3.6.1.4.1.33578.1.1.3.1.3 NAME 'exportsOption'
        DESC 'NFS option for exporting to a particular client'
	EQUALITY caseExactMatch
	SUBSTR caseExactSubstringsMatch
	SYNTAX 1.3.6.1.4.1.1466.115.121.1.15 )

attributetype ( 1.3.6.1.4.1.33578.1.1.3.1.4 NAME 'exportsHost'
        DESC 'Host for which NFS mount point declaration applies'
	EQUALITY caseIgnoreMatch
	SUBSTR caseIgnoreSubstringsMatch
	SYNTAX 1.3.6.1.4.1.1466.115.121.1.15 )

objectclass ( 1.3.6.1.4.1.33578.1.1.3.2.1 NAME 'exportsPoint'
	DESC 'An NFS mount point declaration'
	STRUCTURAL
	SUP top
	MUST ( cn $ exportsPath )
        MAY ( exportsHost ) )

objectclass ( 1.3.6.1.4.1.33578.1.1.3.2.2 NAME 'exportsClient'
	DESC 'Declare NFS access permissions for a particular client'
	STRUCTURAL
	SUP top
	MUST ( exportsClientPattern $ exportsOption ) )
